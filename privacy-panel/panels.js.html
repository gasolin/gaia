<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: panels.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: panels.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * Handles panels.
 *
 * @module PanelController
 * @return {Object}
 */
define([
  'shared/lazy_loader',
  'shared/settings_listener',
  'shared/settings_helper'
],

function(lazyLoader, SettingsListener, SettingsHelper) {
  'use strict';

  function PanelController() {}

  PanelController.prototype = {

    /**
     * Load needed templates.
     *
     * @method load
     * @param  {Array}    sections
     * @param  {Function} callback
     */
    load: function(group, callback) {
      var result = [];
      var sections = document.querySelectorAll(
        'section[data-section="' + group + '"]'
      );

      callback = callback || function() {};

      // Convert sections to normal array
      [].forEach.call(sections, function(section) {
        result.push(section);
      });

      lazyLoader.load(result, function() {
        this.registerEvents(result);
        callback(result);
      }.bind(this));
    },

    /**
     * Show specific section, closes previously opened ones.
     *
     * @method show
     * @param {Object}  p
     * @param {String}  p.id      [optional] Element ID
     * @param {Object}  p.el      [optional] DOM element
     * @param {Boolean} p.back    [optional] Trigger back transition
     * @param {Mixed}   p.options [optional] Passed parameters
     */
    show: function(p) {
      if (p.id &amp;&amp; !p.el) {
        p.el = document.getElementById(p.id);
      }
      _showSection(p.el, p.back, p.options);
    },

    /**
     * Change page
     *
     * @method changePage
     * @param {Object} event
     */
    changePage: function(event) {
      var target, id = this.hash.replace('#', '');

      event.preventDefault();

      if (!id) {
        return;
      }

      target = document.getElementById(id);
      _showSection(target, this.classList.contains('back'));
    },

    /**
     * Register events for given element
     *
     * @method registerEvents
     * @param sections
     */
    registerEvents: function(sections) {
      sections.forEach(function(section) {
        var links = section.querySelectorAll('.pp-link');
        var settings = section.querySelectorAll('input[name], select[name]');

        // Redirect each click on pp-links with href attributes
        [].forEach.call(links, function(link) {
          link.addEventListener('click', this.changePage);
        }.bind(this));

        // Update and save settings on change
        [].forEach.call(settings, function(setting) {
          SettingsListener.observe(
            setting.name,
            setting.dataset.default || false,
            this.updateSetting.bind(setting)
          );
          setting.addEventListener('change', this.saveSetting);
        }.bind(this));
      }.bind(this));
    },

    /**
     * JSON loader
     *
     * @method loadJSON
     * @param {String}   href
     * @param {Function} callback
     */
    loadJSON: function(href, callback) {
      if (!callback) {
        return;
      }

      var xhr = new XMLHttpRequest();
      xhr.onerror = function() {
        console.error('Failed to fetch file: ' + href, xhr.statusText);
      };
      xhr.onload = function() {
        callback(xhr.response);
      };
      xhr.open('GET', href, true); // async
      xhr.responseType = 'json';
      xhr.send();
    },

    /**
     * Update input value
     *
     * @method updateSetting
     * @param  {String} value
     */
    updateSetting: function(value) {
      if (this.type === 'checkbox') {
        this.checked = value;
      } else {
        this.value = value;
      }
    },

    /**
     * Save input value to mozSettings based on inputs name
     *
     * @method saveSetting
     */
    saveSetting: function() {
      var value = this.type === 'checkbox' ? this.checked : this.value;
      SettingsHelper(this.name).set(value);
    }
  };

  /**
   * Show section
   *
   * @private
   * @method showSection
   * @param element
   * @param {Boolean} back
   */
  var _showSection = function(element, back, options) {
    var sections = document.querySelectorAll('section');
    var prevClass = back ? '' : 'previous';
    var event = new CustomEvent('pagerendered', {
      detail: options,
      bubbles: true
    });

    for (var section of sections) {
      if (element.id === 'root' &amp;&amp; section.className !== '') {
        section.className = section.className === 'current' ? prevClass : '';
      }

      if (section.className === 'current') {
        section.className = prevClass;
      }
    }

    element.className = 'current';
    element.dispatchEvent(event);
  };

  return new PanelController();
});
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-About.html">About</a></li><li><a href="module-ALADefineCustomLocation.html">ALADefineCustomLocation</a></li><li><a href="module-ALAException.html">ALAException</a></li><li><a href="module-AlaPanel.html">AlaPanel</a></li><li><a href="module-AppList.html">AppList</a></li><li><a href="module-BlurSlider.html">BlurSlider</a></li><li><a href="module-Commands.html">Commands</a></li><li><a href="module-ExceptionsPanel.html">ExceptionsPanel</a></li><li><a href="module-PanelController.html">PanelController</a></li><li><a href="module-PassCodePanel.html">PassCodePanel</a></li><li><a href="module-PassPhrase.html">PassPhrase</a></li><li><a href="module-RootPanel.html">RootPanel</a></li><li><a href="module-RPExecuteCommands.html">RPExecuteCommands</a></li><li><a href="module-RpPanel.html">RpPanel</a></li><li><a href="module-ScreenLockPanel.html">ScreenLockPanel</a></li><li><a href="module-TcAppDetailsPanel.html">TcAppDetailsPanel</a></li><li><a href="module-TcApplicationsPanel.html">TcApplicationsPanel</a></li><li><a href="module-TcPanel.html">TcPanel</a></li><li><a href="module-TcPermDetailsPanel.html">TcPermDetailsPanel</a></li><li><a href="module-TcPermissionsPanel.html">TcPermissionsPanel</a></li></ul><h3>Classes</h3><ul><li><a href="module-ALADefineCustomLocation-init.html">init</a></li><li><a href="module-ALAException-init.html">init</a></li><li><a href="module-ExceptionsPanel-init.html">init</a></li><li><a href="module-RootPanel-init.html">init</a></li><li><a href="module-RpPanel-init.html">init</a></li></ul><h3>Global</h3><ul><li><a href="global.html#requirejs">requirejs</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.3.0</a> on Mon Jun 08 2015 10:22:04 GMT+0800 (CST)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
